nelmio_api_doc:
    documentation:
        info:
            title: Job Management API
            description: REST API for Job Management System with JWT Authentication
            version: 1.0.0
        
        components:
            securitySchemes:
                bearerAuth:
                    type: http
                    scheme: bearer
                    bearerFormat: JWT
        
        security:
            - bearerAuth: []
        
        paths:
            # Authentication Endpoints
            /api/auth/register:
                post:
                    tags:
                        - Authentication
                    summary: Register a new user
                    security: []
                    requestBody:
                        required: true
                        content:
                            application/json:
                                schema:
                                    type: object
                                    required:
                                        - email
                                        - password
                                        - name
                                        - timezone
                                    properties:
                                        email:
                                            type: string
                                            format: email
                                            example: user@example.com
                                        password:
                                            type: string
                                            minLength: 8
                                            example: password123
                                        name:
                                            type: string
                                            example: John Doe
                                        timezone:
                                            type: string
                                            enum: [UK, MEXICO, INDIA]
                                            example: UK
                    responses:
                        '201':
                            description: User registered successfully
                        '400':
                            description: Missing required fields or validation error
                        '409':
                            description: Email already registered
            
            /api/auth/login:
                post:
                    tags:
                        - Authentication
                    summary: Login user
                    security: []
                    requestBody:
                        required: true
                        content:
                            application/json:
                                schema:
                                    type: object
                                    required:
                                        - email
                                        - password
                                    properties:
                                        email:
                                            type: string
                                            format: email
                                            example: user@example.com
                                        password:
                                            type: string
                                            example: password123
                    responses:
                        '200':
                            description: Login successful
                        '400':
                            description: Missing email or password
                        '401':
                            description: Invalid credentials
            
            /api/auth/me:
                get:
                    tags:
                        - Authentication
                    summary: Get current user information
                    responses:
                        '200':
                            description: User information retrieved successfully
                        '401':
                            description: Unauthorized
            
            # Job Endpoints
            /api/jobs:
                get:
                    tags:
                        - Jobs
                    summary: Get all jobs with optional status filter
                    parameters:
                        - name: status
                          in: query
                          required: false
                          schema:
                              type: string
                              enum: [available, assigned, completed, cancelled]
                          description: Filter jobs by status
                    responses:
                        '200':
                            description: Jobs retrieved successfully
                        '401':
                            description: Unauthorized
                
                post:
                    tags:
                        - Jobs
                    summary: Create a new job
                    requestBody:
                        required: true
                        content:
                            application/json:
                                schema:
                                    type: object
                                    required:
                                        - title
                                        - location
                                    properties:
                                        title:
                                            type: string
                                            example: Plumber needed
                                        description:
                                            type: string
                                            example: Fix kitchen sink
                                        location:
                                            type: string
                                            example: New York, NY
                    responses:
                        '201':
                            description: Job created successfully
                        '400':
                            description: Missing required fields
                        '401':
                            description: Unauthorized
            
            /api/jobs/available:
                get:
                    tags:
                        - Jobs
                    summary: Get all available jobs
                    responses:
                        '200':
                            description: Available jobs retrieved successfully
                        '401':
                            description: Unauthorized
            
            /api/jobs/{id}:
                get:
                    tags:
                        - Jobs
                    summary: Get a single job by ID
                    parameters:
                        - name: id
                          in: path
                          required: true
                          schema:
                              type: integer
                          description: Job ID
                    responses:
                        '200':
                            description: Job retrieved successfully
                        '401':
                            description: Unauthorized
                        '404':
                            description: Job not found
                
                put:
                    tags:
                        - Jobs
                    summary: Update a job (full update)
                    parameters:
                        - name: id
                          in: path
                          required: true
                          schema:
                              type: integer
                          description: Job ID
                    requestBody:
                        required: true
                        content:
                            application/json:
                                schema:
                                    type: object
                                    properties:
                                        title:
                                            type: string
                                        description:
                                            type: string
                                        location:
                                            type: string
                                        status:
                                            type: string
                                            enum: [available, assigned, completed, cancelled]
                    responses:
                        '200':
                            description: Job updated successfully
                        '400':
                            description: Invalid status
                        '401':
                            description: Unauthorized
                        '404':
                            description: Job not found
                
                patch:
                    tags:
                        - Jobs
                    summary: Update a job (partial update)
                    parameters:
                        - name: id
                          in: path
                          required: true
                          schema:
                              type: integer
                          description: Job ID
                    requestBody:
                        required: true
                        content:
                            application/json:
                                schema:
                                    type: object
                                    properties:
                                        title:
                                            type: string
                                        description:
                                            type: string
                                        location:
                                            type: string
                                        status:
                                            type: string
                                            enum: [available, assigned, completed, cancelled]
                    responses:
                        '200':
                            description: Job updated successfully
                        '400':
                            description: Invalid status
                        '401':
                            description: Unauthorized
                        '404':
                            description: Job not found
                
                delete:
                    tags:
                        - Jobs
                    summary: Delete a job
                    parameters:
                        - name: id
                          in: path
                          required: true
                          schema:
                              type: integer
                          description: Job ID
                    responses:
                        '200':
                            description: Job deleted successfully
                        '401':
                            description: Unauthorized
                        '404':
                            description: Job not found
            
            # Job Assignment Endpoints
            /api/assignments:
                get:
                    tags:
                        - Job Assignments
                    summary: Get all assignments for current user with optional status filter
                    parameters:
                        - name: status
                          in: query
                          required: false
                          schema:
                              type: string
                              enum: [scheduled, completed]
                          description: Filter assignments by status
                    responses:
                        '200':
                            description: Assignments retrieved successfully
                        '401':
                            description: Unauthorized
                
                post:
                    tags:
                        - Job Assignments
                    summary: Create a new job assignment
                    requestBody:
                        required: true
                        content:
                            application/json:
                                schema:
                                    type: object
                                    required:
                                        - job_id
                                        - scheduled_date
                                    properties:
                                        job_id:
                                            type: integer
                                            example: 1
                                        scheduled_date:
                                            type: string
                                            format: date-time
                                            example: "2024-12-31 10:00:00"
                    responses:
                        '201':
                            description: Job assigned successfully
                        '400':
                            description: Missing required fields, job not available, or invalid date format
                        '401':
                            description: Unauthorized
                        '404':
                            description: Job not found
            
            /api/assignments/my:
                get:
                    tags:
                        - Job Assignments
                    summary: Get all assignments for current user
                    responses:
                        '200':
                            description: Assignments retrieved successfully
                        '401':
                            description: Unauthorized
            
            /api/assignments/{id}:
                get:
                    tags:
                        - Job Assignments
                    summary: Get a single assignment by ID
                    parameters:
                        - name: id
                          in: path
                          required: true
                          schema:
                              type: integer
                          description: Assignment ID
                    responses:
                        '200':
                            description: Assignment retrieved successfully
                        '401':
                            description: Unauthorized
                        '403':
                            description: Access denied
                        '404':
                            description: Assignment not found
                
                delete:
                    tags:
                        - Job Assignments
                    summary: Delete an assignment
                    parameters:
                        - name: id
                          in: path
                          required: true
                          schema:
                              type: integer
                          description: Assignment ID
                    responses:
                        '200':
                            description: Assignment deleted successfully
                        '401':
                            description: Unauthorized
                        '403':
                            description: Access denied
                        '404':
                            description: Assignment not found
            
            /api/assignments/{id}/complete:
                post:
                    tags:
                        - Job Assignments
                    summary: Mark an assignment as completed
                    parameters:
                        - name: id
                          in: path
                          required: true
                          schema:
                              type: integer
                          description: Assignment ID
                    requestBody:
                        required: true
                        content:
                            application/json:
                                schema:
                                    type: object
                                    required:
                                        - assessment
                                        - rating
                                    properties:
                                        assessment:
                                            type: string
                                            example: Job completed successfully. Customer was satisfied.
                                        rating:
                                            type: integer
                                            minimum: 1
                                            maximum: 5
                                            example: 5
                    responses:
                        '200':
                            description: Assignment completed successfully
                        '400':
                            description: Missing required fields or invalid rating
                        '401':
                            description: Unauthorized
                        '403':
                            description: Access denied
                        '404':
                            description: Assignment not found

    areas:
        path_patterns:
            - ^/api(?!/doc$)